<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
	<section th:fragment=porter>
		<p th:text="${headline}"></p>
		<div id="loginSpotify">
			<form action="#" th:action="@{'/spotifyAuthModifyPlaylist'}"
				method="get">
				<input type="submit" value="登入Spotify" />
			</form>
		</div>
		<form action="#"
			th:action="@{'/porterCarry/'+${source}+'/'+${target}+'/'}"
			method="get">
			<p th:text="'請貼上你的'+${source}+'歌單網址(來源)'"></p>
			<p>
				<input th:type="text" id="accessToken" name="accessToken" />
				<script th:inline="javascript">
					var hash = location.hash.substr(1);

					/**
					 * Obtains parameters from the hash of the URL
					 * @return Object
					 */
					function getHashParams() {
						var hashParams = {};
						var e, r = /([^&;=]+)=?([^&;]*)/g, q = window.location.hash
								.substring(1);
						while (e = r.exec(q)) {
							hashParams[e[1]] = decodeURIComponent(e[2]);
						}
						return hashParams;
					}
					var params = getHashParams();

					var access_token = params.access_token;

					document.getElementById("accessToken").value = access_token;

					document.getElementById("accessToken").style.visibility = "hidden";

					if (document.getElementById("accessToken").value === "undefined") {
						document.getElementById("loginSpotify").style.visibility = "visible";
					} else {
						document.getElementById("loginSpotify").style.visibility = "hidden";
					}
				</script>
			<p>
				<input type="url" name="sourcePlaylist"
					th:placeholder="${sourcePlaceholder}" size=100 autofocus required />
			</p>
			<p th:text="'請貼上你的'+${target}+'歌單網址(目的)'"></p>
			<p>
				<input type="url" name="targetPlaylist"
					th:placeholder="${targetPlaceholder}" size=100 required />
			</p>
			<p>
				<input type="submit" value="送出" />
			</p>
		</form>
	</section>
</body>
</html>